(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(3649)}])},3649:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Home}});var o=n(5893),s=n(7294),i=n(9008),l=n.n(i);function DarkModeToggle(){let[e,t]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{document.documentElement.classList.add("dark"),t(!0)},[]),(0,o.jsx)("div",{className:"toggle-container",onClick:()=>{let n=!e;t(n),n?(document.documentElement.classList.add("dark"),document.documentElement.classList.remove("light")):(document.documentElement.classList.remove("dark"),document.documentElement.classList.add("light"))},role:"button","aria-label":"Toggle dark mode",children:(0,o.jsx)("div",{className:"toggle-dot ".concat(e?"dark":"light")})})}function NodesList(e){let{onNodeSelect:t,className:n="",onNodeClick:i,highlightedNode:l,onHighlightReceived:a}=e,[r,d]=(0,s.useState)([]),[c,h]=(0,s.useState)(null),[u,g]=(0,s.useState)(!0),m=(0,s.useRef)(null);(0,s.useEffect)(()=>{loadNodes()},[]),(0,s.useEffect)(()=>{if(l&&a){a(l);let e=document.querySelector('[data-node-id="'.concat(l.node_id,'"]'));e&&m.current&&e.scrollIntoView({behavior:"smooth",block:"center"})}},[l,a]);let parseCSVLine=e=>{let t=[],n="",o=!1;for(let s=0;s<e.length;s++){let i=e[s];'"'===i&&(0===s||","===e[s-1])?o=!0:'"'===i&&o&&(s===e.length-1||","===e[s+1])?o=!1:","!==i||o?n+=i:(t.push(n.trim()),n="")}return t.push(n.trim()),t},loadNodes=async()=>{try{let e=await fetch("".concat("/data-pipeline","/nodes.csv"));if(e.ok){let t=await e.text(),n=t.split("\n").filter(e=>e.trim()),o=parseCSVLine(n[0]),s=[];for(let e=1;e<n.length;e++){let t=parseCSVLine(n[e]);if(t.length>=o.length-1){let e={};o.forEach((n,o)=>{e[n.trim()]=t[o]?t[o].trim():""}),s.push(e)}}d(s)}else{let e=await fetch("".concat("/data-pipeline/admin","/api/nodes"));if(e.ok){let t=await e.json();d(t)}else d(generateSampleNodes())}}catch(e){console.error("Failed to load nodes:",e),d(generateSampleNodes())}finally{g(!1)}},generateSampleNodes=()=>[{node_id:"eco_001",name:"Economic Data Fetcher",description:"Fetches economic data from USEEIO API",type:"data_fetcher",order:1,processing_time_est:"medium",folder_size:"207M"},{node_id:"zip_001",name:"Zipcode Metrics Generator",description:"Generates zipcode metrics from Census ZBP API",type:"data_processor",order:2,processing_time_est:"fast",folder_size:"24K"},{node_id:"naics_001",name:"NAICS Timeline Aggregator",description:"Aggregates NAICS data across years (2017-2020)",type:"data_aggregator",order:5,processing_time_est:"medium",folder_size:"20K"},{node_id:"ml_001",name:"Random Forest Automator",description:"Automates random forest analysis for poverty prediction",type:"ml_processor",order:9,processing_time_est:"slow",folder_size:"375M"},{node_id:"trade_001",name:"Comtrade Data Fetcher",description:"Fetches trade data from UN Comtrade API",type:"api_fetcher",order:20,processing_time_est:"medium",folder_size:"15M"}],handleNodeClick=(e,n)=>{let o=window.getSelection();o&&o.toString().length>0||(h(n),null==t||t(n),null==i||i())},getTypeColor=e=>({data_fetcher:"text-blue-400",data_processor:"text-cyan-400",data_aggregator:"text-emerald-400",ml_processor:"text-orange-400",api_fetcher:"text-blue-400"})[e]||"text-gray-400";return u?(0,o.jsx)("div",{className:"panel p-6 ".concat(n),children:(0,o.jsxs)("div",{className:"animate-pulse",children:[(0,o.jsx)("div",{className:"h-4 bg-dark-panel-alt rounded mb-4"}),(0,o.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,o.jsx)("div",{className:"h-12 bg-dark-panel-alt rounded"},t))})]})}):(0,o.jsxs)("div",{className:"panel p-4 ".concat(n),children:[(0,o.jsx)("h2",{className:"text-xl mb-3 text-gray-100 light:text-gray-900",children:"Nodes"}),(0,o.jsx)("div",{className:"space-y-2",ref:m,children:r.map(e=>(0,o.jsxs)("div",{"data-node-id":e.node_id,className:"p-3 rounded-lg cursor-pointer transition-all duration-200 border select-text ".concat((null==l?void 0:l.node_id)===e.node_id?"bg-yellow-500/20 border-yellow-500/50 animate-pulse":(null==c?void 0:c.node_id)===e.node_id?"bg-blue-500/10 border-blue-500/30":"bg-gray-700 hover:bg-gray-600 border-gray-600 hover:border-cyan-400/30 light:bg-gray-100 light:hover:bg-gray-50 light:border-gray-300 light:hover:border-cyan-500/30"),onClick:t=>handleNodeClick(t,e),children:[(0,o.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,o.jsx)("div",{className:"flex items-center gap-2",children:(0,o.jsx)("span",{className:"text-sm font-mono text-gray-400",children:e.node_id})}),(0,o.jsx)("span",{className:"text-xs text-gray-400",children:e.folder_size})]}),(0,o.jsx)("h3",{className:"font-semibold text-sm mb-1 text-gray-100 light:text-gray-900",children:e.name}),(0,o.jsx)("p",{className:"text-xs text-muted mb-2 line-clamp-2",children:e.description}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("span",{className:"text-xs font-medium ".concat(getTypeColor(e.type)),children:e.type.replace("_"," ")}),(0,o.jsxs)("span",{className:"text-xs text-gray-400",children:["#",e.order]})]})]},e.node_id))})]})}function FlowChart(e){let{className:t="",onNodeSelect:n,isFloating:i=!1,hideTitle:l=!1,onHighlightInList:a}=e,[r,d]=(0,s.useState)([]),[c,h]=(0,s.useState)([]),[u,g]=(0,s.useState)([]),[m,x]=(0,s.useState)(!0),[p,f]=(0,s.useState)(null),[y,b]=(0,s.useState)({x:0,y:0}),[v,j]=(0,s.useState)(!1),[N,w]=(0,s.useState)({x:0,y:0}),[_,M]=(0,s.useState)({x:0,y:0}),[E,C]=(0,s.useState)(null),[S,z]=(0,s.useState)(null),[R,D]=(0,s.useState)(null),[k,F]=(0,s.useState)({x:0,y:0}),L=(0,s.useRef)(null);(0,s.useEffect)(()=>{loadFlowData()},[]);let loadFlowData=async()=>{try{let e="/data-pipeline",t=await fetch("".concat(e,"/nodes.csv"));if(t.ok){let e=await t.text(),n=e.split("\n").filter(e=>e.trim()),o=n[0].split(",").map(e=>e.trim()),s=[];for(let e=1;e<n.length;e++){let t=n[e].split(",");if(t.length>=o.length-1){let e={};o.forEach((n,o)=>{e[n.trim()]=t[o]?t[o].trim():""}),s.push(e)}}g(s)}let n=await fetch("".concat(e,"/nodes.json"));if(n.ok){let e=await n.json();d(e.nodes||[]),h(e.connections||{})}else generateSampleFlow()}catch(e){console.error("Failed to load flow data:",e),generateSampleFlow()}finally{x(!1)}},generateSampleFlow=()=>{d([{id:"trigger",name:"Start Pipeline",position:[100,300],type:"trigger"},{id:"eco_001",name:"Economic Data Fetcher",position:[300,100],type:"data_fetcher"},{id:"zip_001",name:"Zipcode Metrics",position:[500,200],type:"data_processor"},{id:"naics_001",name:"NAICS Timeline",position:[700,300],type:"data_aggregator"},{id:"ml_001",name:"ML Processor",position:[900,400],type:"ml_processor"}]),h({"Start Pipeline":{main:[[{node:"Economic Data Fetcher",type:"main",index:0}]]},"Economic Data Fetcher":{main:[[{node:"Zipcode Metrics",type:"main",index:0}]]},"Zipcode Metrics":{main:[[{node:"NAICS Timeline",type:"main",index:0}]]},"NAICS Timeline":{main:[[{node:"ML Processor",type:"main",index:0}]]}})},getNodeColor=e=>({trigger:"#10b981",data_fetcher:"#3b82f6",data_processor:"#06b6d4",data_aggregator:"#10b981",ml_processor:"#f59e0b",api_fetcher:"#8b5cf6"})[e]||"#6b7280",handleNodeMouseDown=(e,t)=>{e.preventDefault(),e.stopPropagation();let n=L.current.getBoundingClientRect(),o=L.current.createSVGPoint();o.x=e.clientX-n.left,o.y=e.clientY-n.top;let s=o.matrixTransform(L.current.getScreenCTM().inverse());M({x:e.clientX,y:e.clientY}),f(t.id),b({x:s.x-t.position[0],y:s.y-t.position[1]})},handleNodeClick=(e,t)=>{let o=Math.sqrt(Math.pow(e.clientX-_.x,2)+Math.pow(e.clientY-_.y,2));if(o<5&&n){let e=u.find(e=>e.node_id===t.id);e?n(e):n({node_id:t.id,name:t.name,description:"Pipeline node: ".concat(t.name),type:t.type})}},handleMouseMove=e=>{if(p&&L.current){let t=L.current.getBoundingClientRect(),n=L.current.createSVGPoint();n.x=e.clientX-t.left,n.y=e.clientY-t.top;let o=n.matrixTransform(L.current.getScreenCTM().inverse());d(e=>e.map(e=>e.id===p?{...e,position:[o.x-y.x,o.y-y.y]}:e))}else if(v&&i){let t=e.clientX-N.x,n=e.clientY-N.y;d(e=>e.map(e=>({...e,position:[e.position[0]+t,e.position[1]+n]}))),w({x:e.clientX,y:e.clientY})}},handleMouseUp=e=>{if(p){let t=Math.sqrt(Math.pow(e.clientX-_.x,2)+Math.pow(e.clientY-_.y,2));if(t<5){let t=r.find(e=>e.id===p);t&&handleNodeClick(e,t)}}f(null),b({x:0,y:0}),j(!1)};return((0,s.useEffect)(()=>{if(p||v)return document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp),()=>{document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)}},[p,y,v,N]),(0,s.useEffect)(()=>{let handleClickOutside=e=>{S&&!e.target.closest(".node-menu")&&z(null)};return document.addEventListener("click",handleClickOutside),()=>document.removeEventListener("click",handleClickOutside)},[S]),m)?(0,o.jsx)("div",{className:"panel p-8 ".concat(t),children:(0,o.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-accent-cyan border-t-transparent"})})}):(0,o.jsxs)("div",{className:"panel p-6 ".concat(t),children:[!l&&(0,o.jsx)("h2",{className:"text-xl mb-6 text-gray-100 light:text-gray-900",children:"Pipeline Flow"}),(0,o.jsxs)("div",{className:"relative overflow-auto bg-gray-700 light:bg-gray-300 rounded-lg ".concat(i?"cursor-grab":""),style:{height:l?"calc(100% - 24px)":"600px",overflowX:"auto",overflowY:"auto"},onMouseDown:e=>{i&&!p&&(e.preventDefault(),j(!0),w({x:e.clientX,y:e.clientY}))},children:[(0,o.jsxs)("svg",{ref:L,className:"w-full h-full",viewBox:"0 0 1200 800",style:{minWidth:"1200px",minHeight:"800px"},children:[(0,o.jsx)("defs",{children:(0,o.jsx)("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",children:(0,o.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#06b6d4"})})}),(()=>{let e=[];return Object.entries(c).forEach(t=>{var n,s;let[i,l]=t,a=r.find(e=>e.name===i);a&&(null===(s=l.main)||void 0===s||null===(n=s[0])||void 0===n||n.forEach((t,n)=>{let s=r.find(e=>e.name===t.node);if(!s)return;let l=a.position[0]+120,d=a.position[1]+25,c=s.position[0],h=s.position[1]+25,u=(l+c)/2,g="M ".concat(l," ").concat(d," Q ").concat(u," ").concat(d," ").concat(c," ").concat(h);e.push((0,o.jsx)("g",{children:(0,o.jsx)("path",{d:g,fill:"none",className:"flow-connection",markerEnd:"url(#arrowhead)"})},"".concat(i,"-").concat(t.node,"-").concat(n)))}))}),e})(),r.sort((e,t)=>p===t.id?1:p===e.id?-1:0).map(e=>{var t,n,s;return(0,o.jsxs)("g",{style:{opacity:R===e.id?1:.9},children:[(0,o.jsx)("rect",{x:e.position[0],y:e.position[1],width:"200",height:R===e.id?"120":"50",rx:"8",ry:"8",fill:getNodeColor(e.type),fillOpacity:"0.1",stroke:getNodeColor(e.type),strokeWidth:"2",className:"hover:fill-opacity-20 transition-all duration-200 ".concat(p===e.id?"fill-opacity-30 cursor-grabbing":"cursor-pointer"),onMouseDown:t=>handleNodeMouseDown(t,e),onMouseEnter:()=>C(e.id),onMouseLeave:()=>C(null),style:{cursor:p===e.id?"grabbing":E===e.id?"grab":"pointer"}}),(0,o.jsx)("text",{x:e.position[0]+100,y:e.position[1]+(R===e.id?20:30),textAnchor:"middle",className:"text-sm font-medium fill-current text-gray-100 pointer-events-none select-none",onMouseDown:t=>handleNodeMouseDown(t,e),children:e.name}),R===e.id&&(0,o.jsxs)("g",{children:[(0,o.jsxs)("text",{x:e.position[0]+10,y:e.position[1]+40,className:"text-xs fill-current text-gray-200 pointer-events-none select-none",children:["ID: ",e.id]}),(0,o.jsxs)("text",{x:e.position[0]+10,y:e.position[1]+55,className:"text-xs fill-current text-gray-200 pointer-events-none select-none",children:["Type: ",null===(t=e.type)||void 0===t?void 0:t.replace("_"," ")]}),(0,o.jsx)("text",{x:e.position[0]+10,y:e.position[1]+70,className:"text-xs fill-current text-gray-200 pointer-events-none select-none",children:"Status: Active"}),(null===(n=u.find(t=>t.node_id===e.id))||void 0===n?void 0:n.description)&&(0,o.jsxs)("text",{x:e.position[0]+10,y:e.position[1]+85,className:"text-xs fill-current text-gray-200 pointer-events-none select-none",children:[null===(s=u.find(t=>t.node_id===e.id))||void 0===s?void 0:s.description.substring(0,30),"..."]})]}),(0,o.jsxs)("g",{className:"node-menu",children:[(0,o.jsx)("circle",{cx:e.position[0]+185,cy:e.position[1]+15,r:"12",fill:"rgba(0,0,0,0.1)",className:"hover:fill-opacity-20 cursor-pointer",onClick:t=>{t.stopPropagation();let n=L.current.getBoundingClientRect();F({x:t.clientX-n.left,y:t.clientY-n.top}),z(S===e.id?null:e.id)}}),(0,o.jsx)("text",{x:e.position[0]+185,y:e.position[1]+20,textAnchor:"middle",className:"text-xs fill-current text-gray-300 pointer-events-none select-none",style:{fontSize:"10px"},children:"⋮"})]})]},e.id)})]}),S&&(0,o.jsxs)("div",{className:"absolute bg-gray-800 border border-gray-600 rounded-lg shadow-lg py-2 z-50 light:bg-gray-200 light:border-gray-400",style:{left:"".concat(k.x,"px"),top:"".concat(k.y,"px")},children:[(0,o.jsx)("button",{className:"w-full px-4 py-2 text-left text-sm text-gray-100 hover:bg-gray-700 light:text-gray-900 light:hover:bg-gray-100",onClick:()=>{let e=u.find(e=>e.node_id===S);e&&a&&a(e),z(null)},children:"Select in list"}),(0,o.jsx)("button",{className:"w-full px-4 py-2 text-left text-sm text-gray-100 hover:bg-gray-700 light:text-gray-900 light:hover:bg-gray-100",onClick:()=>{D(R===S?null:S),z(null)},children:R===S?"Collapse Node":"Expand Node"})]})]})]})}function NodeDetailPanel(e){var t;let{node:n,onUpdateNode:i,onRunNode:l}=e,[a,r]=(0,s.useState)((null==n?void 0:n.todos)||""),[d,c]=(0,s.useState)(""),[h,u]=(0,s.useState)(!1),[g,m]=(0,s.useState)(null);if(!n)return(0,o.jsx)("div",{className:"panel p-8 flex items-center justify-center text-center",children:(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-700 flex items-center justify-center",children:(0,o.jsx)("span",{className:"text-2xl",children:"\uD83D\uDD27"})}),(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-100 mb-2",children:"Select a Node"}),(0,o.jsx)("p",{className:"text-muted",children:"Choose a pipeline node from the list to view details and controls"})]})});let handleTodosUpdate=async()=>{try{let e=await fetch("".concat("/data-pipeline/admin","/api/nodes/update"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({node_id:n.node_id,todos:a})});e.ok?(null==i||i({...n,todos:a}),alert("TODOs updated successfully!")):alert("Failed to update TODOs")}catch(e){console.error("Error updating TODOs:",e),alert("Error updating TODOs")}},handleRunNode=async()=>{if(!n.python_cmds){alert("No Python command available for this node");return}u(!0),m(null);try{let e=await fetch("".concat("/data-pipeline/admin","/api/nodes/run"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({node_id:n.node_id,command:n.python_cmds,working_directory:n.link})}),t=await e.json();m(t),null==l||l(n,t)}catch(e){console.error("Error running node:",e),m({success:!1,error:e.message})}finally{u(!1)}};return(0,o.jsxs)("div",{className:"panel space-y-6 select-text",style:{padding:"29px"},children:[(0,o.jsxs)("div",{className:"border-b border-gray-700 pb-4",children:[(0,o.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsx)("span",{className:"text-2xl",children:{data_fetcher:"\uD83D\uDCE5",data_processor:"⚙️",data_aggregator:"\uD83D\uDCCA",ml_processor:"\uD83E\uDD16",api_fetcher:"\uD83C\uDF10",data_cleaner:"\uD83E\uDDF9",data_merger:"\uD83D\uDD17",structure_creator:"\uD83D\uDCC1",batch_processor:"⚡"}[n.type]||"\uD83D\uDD27"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{className:"text-xl font-bold text-gray-100",children:n.name}),(0,o.jsx)("p",{className:"text-sm font-mono text-cyan-400",children:n.node_id})]})]}),(0,o.jsx)("span",{className:"text-sm font-medium px-3 py-1 rounded-full border ".concat("yes"===n.n8n_parallel_safe?"text-emerald-400 border-emerald-400/30 bg-emerald-400/10":"text-orange-400 border-orange-400/30 bg-orange-400/10"),children:"yes"===n.n8n_parallel_safe?"Parallel Safe":"Sequential Only"})]}),(0,o.jsx)("p",{className:"text-muted",children:n.description})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-100 mb-1",children:"Processing Time"}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("span",{className:"text-sm bg-gray-700 px-3 py-1 rounded-lg",children:n.processing_time_est}),"yes"===n.rate_limited&&(0,o.jsx)("span",{className:"text-xs text-orange-400",children:"⚠️ Rate Limited"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-100 mb-1",children:"Folder Size"}),(0,o.jsx)("span",{className:"text-sm bg-gray-700 px-3 py-1 rounded-lg",children:n.folder_size})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-100 mb-1",children:"Dependencies"}),(0,o.jsx)("div",{className:"flex flex-wrap gap-1",children:null===(t=n.dependencies)||void 0===t?void 0:t.split(",").map((e,t)=>(0,o.jsx)("span",{className:"text-xs bg-blue-500/10 text-blue-400 px-2 py-1 rounded",children:e.trim()},t))})]})]}),(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-100 mb-1",children:"Output Path"}),(0,o.jsx)("span",{className:"text-sm bg-gray-700 px-3 py-1 rounded-lg font-mono",children:n.output_path})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-100 mb-1",children:"Data Sources"}),(0,o.jsx)("span",{className:"text-sm text-muted",children:n.data_sources})]}),n.api_keys_required&&"none"!==n.api_keys_required&&(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-100 mb-1",children:"API Keys Required"}),(0,o.jsx)("span",{className:"text-sm text-orange-400",children:n.api_keys_required})]})]})]}),n.python_cmds&&(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-100 mb-2",children:"Python Command"}),(0,o.jsx)("div",{className:"bg-gray-700 rounded-lg p-3 mb-3",children:(0,o.jsx)("code",{className:"text-sm font-mono text-cyan-400",children:n.python_cmds})}),(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsx)("button",{onClick:handleRunNode,disabled:h,className:"btn-primary ".concat(h?"opacity-50 cursor-not-allowed":""),children:h?"\uD83D\uDD04 Running...":"▶️ Run Process"}),(0,o.jsxs)("span",{className:"text-sm ".concat(h?"text-orange-400":(null==g?void 0:g.success)?"text-emerald-400":(null==g?void 0:g.success)===!1?"text-red-500":"text-gray-400"),children:[h&&"Running...",(null==g?void 0:g.success)===!0&&"✅ Success",(null==g?void 0:g.success)===!1&&"❌ Failed"]})]})]}),g&&(0,o.jsxs)("div",{className:"rounded-lg p-4 ".concat(g.success?"bg-emerald-500/10 border border-emerald-500/30":"bg-red-500/10 border border-red-500/30"),children:[(0,o.jsx)("h4",{className:"font-medium mb-2",children:"Execution Result:"}),(0,o.jsx)("pre",{className:"text-sm font-mono overflow-auto max-h-32",children:g.output||g.error})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-100 mb-2",children:"Team TODOs"}),(0,o.jsx)("textarea",{value:a,onChange:e=>r(e.target.value),className:"w-full h-24 bg-gray-700 border border-gray-600 rounded-lg p-3 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-blue-500/50 text-gray-100",placeholder:""}),(0,o.jsx)("button",{onClick:handleTodosUpdate,className:"btn-accent mt-2",children:"\uD83D\uDCBE Update TODOs"})]}),(0,o.jsx)("div",{className:"border-t border-gray-700 pt-4",children:(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("input",{type:"text",value:d,onChange:e=>c(e.target.value),className:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 text-gray-100",placeholder:"Add new TODO item...",onKeyPress:e=>{if("Enter"===e.key&&d.trim()){let e=a?"".concat(a,"\n- ").concat(d.trim()):"- ".concat(d.trim());r(e),c("")}}}),(0,o.jsx)("button",{onClick:()=>{if(d.trim()){let e=a?"".concat(a,"\n- ").concat(d.trim()):"- ".concat(d.trim());r(e),c("")}},className:"btn-accent px-4",disabled:!d.trim(),children:"Add"})]})})]})}function EdgeResizeHandle(e){let{onResize:t,edge:n,className:i="",onDoubleClick:l}=e,[a,r]=(0,s.useState)(!1),[d,c]=(0,s.useState)({x:0,y:0}),[h,u]=(0,s.useState)({width:0,height:0}),handleMouseMove=e=>{if(a&&t){let o=e.clientX-d.x,s=e.clientY-d.y,i=h.width,l=h.height;switch(n){case"top":l=h.height-s;break;case"bottom":l=h.height+s;break;case"left":i=h.width-o;break;case"right":i=h.width+o}t({width:Math.max(200,i),height:Math.max(150,l)})}},handleMouseUp=()=>{r(!1)};return(0,s.useEffect)(()=>{if(a)return document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp),()=>{document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)}},[a,d,h]),(0,o.jsx)("div",{className:i,style:(()=>{let e={position:"absolute",backgroundColor:"transparent"};switch(n){case"top":return{...e,top:"0",left:"8px",right:"8px",height:"4px",cursor:"n-resize"};case"bottom":return{...e,bottom:"0",left:"8px",right:"8px",height:"4px",cursor:"s-resize"};case"left":return{...e,left:"0",top:"8px",bottom:"8px",width:"4px",cursor:"w-resize"};case"right":return{...e,right:"0",top:"8px",bottom:"8px",width:"4px",cursor:"e-resize"};default:return e}})(),onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),r(!0),c({x:e.clientX,y:e.clientY});let t=e.target.closest("[data-resizable]");if(t){let e=t.getBoundingClientRect();u({width:e.width,height:e.height})}}})}function CornerResizeHandle(e){let{onResize:t,corner:n,className:i=""}=e,[l,a]=(0,s.useState)(!1),[r,d]=(0,s.useState)({x:0,y:0}),[c,h]=(0,s.useState)({width:0,height:0}),handleMouseMove=e=>{if(l&&t){let o=e.clientX-r.x,s=e.clientY-r.y,i=c.width,l=c.height;switch(n){case"top-left":i=c.width-o,l=c.height-s;break;case"top-right":i=c.width+o,l=c.height-s;break;case"bottom-left":i=c.width-o,l=c.height+s;break;case"bottom-right":i=c.width+o,l=c.height+s}t({width:Math.max(200,i),height:Math.max(150,l)})}},handleMouseUp=()=>{a(!1)};return(0,s.useEffect)(()=>{if(l)return document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp),()=>{document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)}},[l,r,c]),(0,o.jsx)("div",{className:i,style:(()=>{let e={position:"absolute",width:"16px",height:"16px",backgroundColor:"transparent"};switch(n){case"top-left":return{...e,top:"0",left:"0",cursor:"nw-resize"};case"top-right":return{...e,top:"0",right:"0",cursor:"ne-resize"};case"bottom-left":return{...e,bottom:"0",left:"0",cursor:"sw-resize"};case"bottom-right":return{...e,bottom:"0",right:"0",cursor:"se-resize"};default:return e}})(),onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),a(!0),d({x:e.clientX,y:e.clientY});let t=e.target.closest("[data-resizable]");if(t){let e=t.getBoundingClientRect();h({width:e.width,height:e.height})}}})}function DraggableModal(e){let{onClose:t,onNodeSelect:n,onFocus:i,onNodeClick:l,hideTitle:a=!1,highlightedNode:r,onHighlightReceived:d}=e,[c,h]=(0,s.useState)({x:100,y:100}),[u,g]=(0,s.useState)({width:320,height:384}),[m,x]=(0,s.useState)(!1),[p,f]=(0,s.useState)({x:0,y:0}),y=(0,s.useRef)(null),getFloatingPosition=()=>{let e=window.innerWidth,t=window.innerHeight-81;return{x:20,y:100,width:Math.floor(e/3)-40,height:Math.floor(t/2)-20}},handleMouseMove=e=>{m&&h({x:e.clientX-p.x,y:e.clientY-p.y})},handleMouseUp=()=>{x(!1)};return(0,s.useEffect)(()=>{if(m)return document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp),()=>{document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)}},[m,p,c]),(0,s.useEffect)(()=>{let handleReset=()=>{let e=getFloatingPosition();h({x:e.x,y:e.y}),g({width:e.width,height:e.height})};return window.addEventListener("resetFloatingPositions",handleReset),()=>window.removeEventListener("resetFloatingPositions",handleReset)},[]),(0,o.jsxs)("div",{ref:y,"data-resizable":!0,className:"absolute bg-gray-800 border border-gray-700 rounded-3xl shadow-2xl overflow-hidden light:bg-gray-200 light:border-gray-400",style:{left:"".concat(c.x,"px"),top:"".concat(c.y,"px"),width:"".concat(u.width,"px"),height:"".concat(u.height,"px"),zIndex:50},onMouseDown:e=>{null==i||i(),e.target.closest(".drag-handle")&&(x(!0),f({x:e.clientX-c.x,y:e.clientY-c.y}))},onClick:()=>null==i?void 0:i(),children:[(0,o.jsxs)("div",{className:"drag-handle flex items-center justify-between p-4 bg-gray-700 border-b border-gray-600 cursor-move light:bg-gray-300 light:border-gray-400",children:[(0,o.jsx)("h2",{className:"text-lg font-semibold text-gray-100 light:text-gray-900 select-none",children:"Nodes"}),(0,o.jsx)("button",{onClick:t,className:"w-8 h-8 rounded-full bg-gray-600 hover:bg-red-600 flex items-center justify-center transition-colors duration-200 light:bg-gray-400 light:hover:bg-red-500",children:(0,o.jsx)("span",{className:"text-gray-100 text-xl font-bold light:text-gray-900",children:"\xd7"})})]}),(0,o.jsx)("div",{className:"p-4 overflow-y-auto",style:{height:"calc(100% - 60px)"},children:(0,o.jsx)(NodesList,{onNodeSelect:n,onNodeClick:l,highlightedNode:r,onHighlightReceived:d,className:"bg-transparent border-none p-0"})}),(0,o.jsx)(EdgeResizeHandle,{edge:"top",onResize:g}),(0,o.jsx)(EdgeResizeHandle,{edge:"bottom",onResize:g}),(0,o.jsx)(EdgeResizeHandle,{edge:"left",onResize:g}),(0,o.jsx)(EdgeResizeHandle,{edge:"right",onResize:g}),(0,o.jsx)(CornerResizeHandle,{corner:"top-left",onResize:g}),(0,o.jsx)(CornerResizeHandle,{corner:"top-right",onResize:g}),(0,o.jsx)(CornerResizeHandle,{corner:"bottom-left",onResize:g}),(0,o.jsx)(CornerResizeHandle,{corner:"bottom-right",onResize:g})]})}function FloatingDetailPanel(e){let{node:t,onClose:n,onUpdateNode:i,onRunNode:l,onFocus:a}=e,[r,d]=(0,s.useState)({x:200,y:150}),[c,h]=(0,s.useState)({width:576,height:600}),[u,g]=(0,s.useState)(!1),[m,x]=(0,s.useState)({x:0,y:0}),p=(0,s.useRef)(null),getFloatingPosition=()=>{let e=window.innerWidth,t=window.innerHeight-81;return{x:Math.floor(e/3)+20,y:100,width:Math.floor(2*e/3)-40,height:Math.floor(t/2)-20}},handleMouseMove=e=>{u&&d({x:e.clientX-m.x,y:e.clientY-m.y})},handleMouseUp=()=>{g(!1)};return((0,s.useEffect)(()=>{if(u)return document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp),()=>{document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)}},[u,m,r]),(0,s.useEffect)(()=>{let handleReset=()=>{let e=getFloatingPosition();d({x:e.x,y:e.y}),h({width:e.width,height:e.height})};return window.addEventListener("resetFloatingPositions",handleReset),()=>window.removeEventListener("resetFloatingPositions",handleReset)},[]),t)?(0,o.jsxs)("div",{ref:p,"data-resizable":!0,className:"absolute bg-gray-800 border border-gray-700 rounded-3xl shadow-2xl overflow-hidden light:bg-gray-200 light:border-gray-400",style:{left:"".concat(r.x,"px"),top:"".concat(r.y,"px"),width:"".concat(c.width,"px"),height:"".concat(c.height,"px"),zIndex:50},onMouseDown:e=>{null==a||a(),e.target.closest(".drag-handle")&&(g(!0),x({x:e.clientX-r.x,y:e.clientY-r.y}))},onClick:()=>null==a?void 0:a(),children:[(0,o.jsxs)("div",{className:"drag-handle flex items-center justify-between p-4 bg-gray-700 border-b border-gray-600 cursor-move light:bg-gray-300 light:border-gray-400",children:[(0,o.jsx)("h2",{className:"text-lg font-semibold text-gray-100 light:text-gray-900 select-none",children:"Node Details"}),(0,o.jsx)("button",{onClick:n,className:"w-8 h-8 rounded-full bg-gray-600 hover:bg-red-600 flex items-center justify-center transition-colors duration-200 light:bg-gray-400 light:hover:bg-red-500",children:(0,o.jsx)("span",{className:"text-gray-100 text-xl font-bold light:text-gray-900",children:"\xd7"})})]}),(0,o.jsx)("div",{className:"overflow-y-auto",style:{height:"calc(100% - 60px)"},children:(0,o.jsx)(NodeDetailPanel,{node:t,onUpdateNode:i,onRunNode:l})}),(0,o.jsx)(EdgeResizeHandle,{edge:"top",onResize:h}),(0,o.jsx)(EdgeResizeHandle,{edge:"bottom",onResize:h}),(0,o.jsx)(EdgeResizeHandle,{edge:"left",onResize:h}),(0,o.jsx)(EdgeResizeHandle,{edge:"right",onResize:h}),(0,o.jsx)(CornerResizeHandle,{corner:"top-left",onResize:h}),(0,o.jsx)(CornerResizeHandle,{corner:"top-right",onResize:h}),(0,o.jsx)(CornerResizeHandle,{corner:"bottom-left",onResize:h}),(0,o.jsx)(CornerResizeHandle,{corner:"bottom-right",onResize:h})]}):null}function DraggableFlowChart(e){let{onNodeSelect:t,onClose:n,onFocus:i,isFullWidth:l=!1,hideTitle:a=!1,onHighlightInList:r}=e,[d,c]=(0,s.useState)({x:100,y:100}),[h,u]=(0,s.useState)({width:800,height:700}),[g,m]=(0,s.useState)(!1),[x,p]=(0,s.useState)({x:0,y:0}),f=(0,s.useRef)(null),getFloatingPosition=()=>{let e=window.innerWidth,t=window.innerHeight-81;return{x:20,y:100+(Math.floor(t/2)-20)+40,width:Math.floor(e/3)-40,height:Math.floor(t/2)-60}},handleMouseMove=e=>{g&&c({x:e.clientX-x.x,y:e.clientY-x.y})},handleMouseUp=()=>{m(!1)};return(0,s.useEffect)(()=>{if(g)return document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp),()=>{document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp)}},[g,x,d]),(0,s.useEffect)(()=>{let handleReset=()=>{let e=getFloatingPosition();c({x:e.x,y:e.y}),u({width:e.width,height:e.height})};return window.addEventListener("resetFloatingPositions",handleReset),()=>window.removeEventListener("resetFloatingPositions",handleReset)},[]),(0,o.jsxs)("div",{ref:f,"data-resizable":!0,className:"absolute bg-gray-800 border border-gray-700 rounded-3xl shadow-2xl overflow-hidden light:bg-gray-200 light:border-gray-400",style:{left:"".concat(d.x,"px"),top:"".concat(d.y,"px"),width:"".concat(h.width,"px"),height:"".concat(h.height,"px"),zIndex:45},onMouseDown:e=>{null==i||i(),e.target.closest(".drag-handle")&&(m(!0),p({x:e.clientX-d.x,y:e.clientY-d.y}))},onClick:()=>null==i?void 0:i(),children:[(0,o.jsxs)("div",{className:"drag-handle flex items-center justify-between p-4 bg-gray-700 border-b border-gray-600 cursor-move light:bg-gray-300 light:border-gray-400",children:[(0,o.jsx)("h2",{className:"text-lg font-semibold text-gray-100 light:text-gray-900 select-none",children:"Pipeline Flow"}),(0,o.jsx)("button",{onClick:n,className:"w-8 h-8 rounded-full bg-gray-600 hover:bg-red-600 flex items-center justify-center transition-colors duration-200 light:bg-gray-400 light:hover:bg-red-500",children:(0,o.jsx)("span",{className:"text-gray-100 text-xl font-bold light:text-gray-900",children:"\xd7"})})]}),(0,o.jsx)("div",{className:"h-[calc(100%-60px)] overflow-hidden",children:(0,o.jsx)(FlowChart,{className:"h-full",onNodeSelect:t,isFloating:!0,hideTitle:!0,onHighlightInList:r})}),!l&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(EdgeResizeHandle,{edge:"top",onResize:u}),(0,o.jsx)(EdgeResizeHandle,{edge:"bottom",onResize:u}),(0,o.jsx)(EdgeResizeHandle,{edge:"left",onResize:u}),(0,o.jsx)(EdgeResizeHandle,{edge:"right",onResize:u}),(0,o.jsx)(CornerResizeHandle,{corner:"top-left",onResize:u}),(0,o.jsx)(CornerResizeHandle,{corner:"top-right",onResize:u}),(0,o.jsx)(CornerResizeHandle,{corner:"bottom-left",onResize:u}),(0,o.jsx)(CornerResizeHandle,{corner:"bottom-right",onResize:u})]})]})}function Home(){let[e,t]=(0,s.useState)(null),[n,i]=(0,s.useState)("column"),[a,r]=(0,s.useState)(!1),[d,c]=(0,s.useState)(!1),[h,u]=(0,s.useState)(!1),[g,m]=(0,s.useState)({list:40,chart:41,detail:42}),[x,p]=(0,s.useState)(null),handleNodeSelect=e=>{t(e),c(!0)},bringToFront=e=>{let t=Math.max(...Object.values(g));m(n=>({...n,[e]:t+1}))},handleHighlightInList=e=>{p(e),bringToFront("detail"),setTimeout(()=>p(null),3e3)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(l(),{children:[(0,o.jsx)("title",{children:"Data Pipeline Admin"}),(0,o.jsx)("meta",{name:"description",content:"Data Pipeline Administration Interface"}),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,o.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,o.jsxs)("div",{className:"min-h-screen bg-gray-900 light:bg-yellow-50 ".concat("floating"===n?"overflow-auto":""),style:"floating"===n?{height:"100vh"}:{},children:[(0,o.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-700 light:border-gray-400 relative z-50",children:[(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("button",{onClick:()=>i("column"),className:"btn text-sm px-3 py-2 ".concat("column"===n?"btn-primary":""),title:"Column Layout",children:"▦"}),(0,o.jsx)("button",{onClick:()=>{i("full-width"),r(!0)},className:"btn text-sm px-3 py-2 ".concat("full-width"===n?"btn-primary":""),title:"Full Width Layout",children:"▬"}),(0,o.jsx)("button",{onClick:()=>{i("floating"),r(!0),u(!0),window.dispatchEvent(new CustomEvent("resetFloatingPositions"))},className:"btn text-sm px-3 py-2 ".concat("floating"===n?"btn-primary":""),title:"Floating Layout",children:"⧉"})]}),(0,o.jsx)(DarkModeToggle,{})]}),(0,o.jsxs)("div",{className:"flex ".concat("floating"===n?"h-auto min-h-[calc(100vh-81px)]":"h-[calc(100vh-81px)]"),children:["column"===n&&(0,o.jsx)("div",{className:"w-[30%] border-r border-gray-700 light:border-gray-400 p-6 overflow-y-auto",children:(0,o.jsx)(NodesList,{onNodeSelect:handleNodeSelect,onNodeClick:()=>bringToFront("detail"),highlightedNode:x,onHighlightReceived:t,className:"h-auto"})}),(0,o.jsx)("div",{className:"flex-1 ".concat("column"===n?"w-[70%]":"w-full"),children:(0,o.jsxs)("div",{className:"h-full",children:["floating"!==n&&(0,o.jsx)("div",{className:"h-full p-6",children:(0,o.jsx)(FlowChart,{className:"h-full",onNodeSelect:handleNodeSelect,isFloating:!1,onHighlightInList:handleHighlightInList})}),"floating"===n&&(0,o.jsx)("div",{className:"h-full flex items-center justify-center p-6",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("button",{onClick:()=>{r(!0),u(!0),setTimeout(()=>{window.dispatchEvent(new CustomEvent("resetFloatingPositions"))},100)},className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-700 flex items-center justify-center light:bg-gray-300 hover:bg-gray-600 light:hover:bg-gray-400 transition-colors duration-200 cursor-pointer",children:(0,o.jsx)("span",{className:"text-2xl",children:"⧉"})}),(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-100 mb-2 light:text-gray-900",children:"Floating Mode Active"}),(0,o.jsx)("p",{className:"text-muted",children:"Click the icon above to open floating panels"})]})})]})})]}),("floating"===n||"full-width"===n)&&a&&(0,o.jsx)("div",{className:"fixed inset-0 pointer-events-none",id:"listPopup",style:{zIndex:g.list},children:(0,o.jsx)("div",{className:"pointer-events-auto",children:(0,o.jsx)(DraggableModal,{onClose:()=>r(!1),onNodeSelect:e=>{handleNodeSelect(e)},onFocus:()=>bringToFront("list"),onNodeClick:()=>bringToFront("detail"),highlightedNode:x,onHighlightReceived:t,hideTitle:"floating"===n})})}),("floating"===n||"full-width"===n)&&h&&(0,o.jsx)("div",{className:"fixed inset-0 pointer-events-none",style:{zIndex:g.chart},children:(0,o.jsx)("div",{className:"pointer-events-auto",children:(0,o.jsx)(DraggableFlowChart,{onNodeSelect:handleNodeSelect,onClose:()=>u(!1),onFocus:()=>bringToFront("chart"),isFullWidth:"full-width"===n,hideTitle:"floating"===n,onHighlightInList:handleHighlightInList})})}),d&&e&&(0,o.jsx)("div",{className:"fixed inset-0 pointer-events-none",style:{zIndex:g.detail},children:(0,o.jsx)("div",{className:"pointer-events-auto",children:(0,o.jsx)(FloatingDetailPanel,{node:e,onClose:()=>c(!1),onUpdateNode:e=>{t(e)},onRunNode:(e,t)=>{console.log("Node run result:",{node:e,result:t})},onFocus:()=>bringToFront("detail")})})})]})]})}},9008:function(e,t,n){e.exports=n(9201)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);